#!/usr/bin/env ruby

require 'qtools'
require 'optparse'

options = {}
OptionParser.new do |opts|
  opts.banner = "Usage: qnodes [options]"

  opts.on("-m", "--memory", "Sort free nodes by available memory") do |m|
    options[:memory] = m
  end
end.parse!

flags = []
flags << (options[:memory] ? '-k5nr' : '-k3n')
flags_str = flags.join(' ')

puts `qhost | head -n2`
puts `qhost | grep free | sort #{flags_str}`
